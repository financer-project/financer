model User {
    id             String   @id @default(uuid())
    createdAt      DateTime @default(now())
    updatedAt      DateTime @updatedAt
    firstName      String
    lastName       String
    email          String   @unique
    hashedPassword String?
    role           Role     @default(USER)
    avatarPath     String?

    tokens      Token[]
    sessions    Session[]
    memberships HouseholdMembership[]
    settings    Settings?             @relation("UserSettings")

    createdTransactions         Transaction[]         @relation("TransactionCreatedBy")
    createdHouseholds           Household[]           @relation("HouseholdCreatedBy")
    createdTransactionTemplates TransactionTemplate[] @relation("TransactionTemplateCreatedBy")
}

model Settings {
    user   User   @relation(name: "UserSettings", fields: [userId], references: [id])
    userId String @unique

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    language String @default("en-US")
    theme    String @default("light")

    @@id([userId])
}

model Session {
    id                 String    @id @default(uuid())
    createdAt          DateTime  @default(now())
    updatedAt          DateTime  @updatedAt
    expiresAt          DateTime?
    handle             String    @unique
    hashedSessionToken String?
    antiCSRFToken      String?
    publicData         String?
    privateData        String?

    user   User?   @relation(fields: [userId], references: [id])
    userId String?
}

model Token {
    id          String    @id @default(uuid())
    createdAt   DateTime  @default(now())
    updatedAt   DateTime  @updatedAt
    hashedToken String
    type        TokenType
    expiresAt   DateTime
    sentTo      String
    content     Json?

    user   User   @relation(fields: [userId], references: [id])
    userId String

    @@unique([hashedToken, type])
}

enum TokenType {
    RESET_PASSWORD
    INVITATION
    INVITATION_HOUSEHOLD
}

enum Role {
    USER
    ADMIN
}
